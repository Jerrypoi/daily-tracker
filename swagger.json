{
    "swagger": "2.0",
    "info": {
        "description": "Daily tracker backend API",
        "version": "1.0.0",
        "title": "Daily Tracker Backend API"
    },
    "host": "localhost:8080",
    "basePath": "/api/v1",
    "tags": [
        {
            "name": "Topic",
            "description": "Topic is the category of your daily activities. You can create a topic and assign it to a daily track."
        },
        {
            "name": "DailyTrack",
            "description": "Manage your daily track records. Each record represents a 30-minute time period."
        }
    ],
    "schemes": [
        "http"
    ],
    "paths": {
        "/topics": {
            "get": {
                "tags": ["Topic"],
                "summary": "Get all topics",
                "description": "Retrieves a list of all topics. Supports optional filtering by parent_topic_id.",
                "operationId": "getTopics",
                "produces": ["application/json"],
                "parameters": [
                    {
                        "name": "parent_topic_id",
                        "in": "query",
                        "description": "Filter topics by parent topic ID.",
                        "required": false,
                        "type": "integer",
                        "format": "int64"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/Topic"
                            }
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/ErrorResponse"
                        }
                    }
                }
            },
            "post": {
                "tags": ["Topic"],
                "summary": "Create a new topic",
                "description": "Creates a new topic with the given name and optional parent topic.",
                "operationId": "createTopic",
                "consumes": ["application/json"],
                "produces": ["application/json"],
                "parameters": [
                    {
                        "in": "body",
                        "name": "body",
                        "description": "Topic object to be created",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/CreateTopicRequest"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Topic created successfully",
                        "schema": {
                            "$ref": "#/definitions/Topic"
                        }
                    },
                    "400": {
                        "description": "Invalid input",
                        "schema": {
                            "$ref": "#/definitions/ErrorResponse"
                        }
                    },
                    "409": {
                        "description": "Topic name already exists",
                        "schema": {
                            "$ref": "#/definitions/ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/ErrorResponse"
                        }
                    }
                }
            }
        },
        "/topics/{id}": {
            "get": {
                "tags": ["Topic"],
                "summary": "Get a topic by ID",
                "description": "Retrieves a single topic by its ID.",
                "operationId": "getTopicById",
                "produces": ["application/json"],
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of the topic to retrieve",
                        "required": true,
                        "type": "integer",
                        "format": "int64"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "schema": {
                            "$ref": "#/definitions/Topic"
                        }
                    },
                    "404": {
                        "description": "Topic not found",
                        "schema": {
                            "$ref": "#/definitions/ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/ErrorResponse"
                        }
                    }
                }
            }
        },
        "/daily-tracks": {
            "get": {
                "tags": ["DailyTrack"],
                "summary": "Get daily track records",
                "description": "Retrieves a list of daily track records. Supports filtering by date range and topic.",
                "operationId": "getDailyTracks",
                "produces": ["application/json"],
                "parameters": [
                    {
                        "name": "start_date",
                        "in": "query",
                        "description": "Filter records starting from this date (inclusive). Format: YYYY-MM-DD",
                        "required": false,
                        "type": "string",
                        "format": "date"
                    },
                    {
                        "name": "end_date",
                        "in": "query",
                        "description": "Filter records up to this date (inclusive). Format: YYYY-MM-DD",
                        "required": false,
                        "type": "string",
                        "format": "date"
                    },
                    {
                        "name": "topic_id",
                        "in": "query",
                        "description": "Filter records by topic ID",
                        "required": false,
                        "type": "integer",
                        "format": "int64"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/DailyTrack"
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid date format or parameters",
                        "schema": {
                            "$ref": "#/definitions/ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/ErrorResponse"
                        }
                    }
                }
            },
            "post": {
                "tags": ["DailyTrack"],
                "summary": "Create a new daily track record",
                "description": "Creates a new daily track record. The start_time must be at :00 or :30 minutes of an hour.",
                "operationId": "createDailyTrack",
                "consumes": ["application/json"],
                "produces": ["application/json"],
                "parameters": [
                    {
                        "in": "body",
                        "name": "body",
                        "description": "Daily track record to be created",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/CreateDailyTrackRequest"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Daily track record created successfully",
                        "schema": {
                            "$ref": "#/definitions/DailyTrack"
                        }
                    },
                    "400": {
                        "description": "Invalid input (e.g., start_time not at :00 or :30)",
                        "schema": {
                            "$ref": "#/definitions/ErrorResponse"
                        }
                    },
                    "404": {
                        "description": "Referenced topic not found",
                        "schema": {
                            "$ref": "#/definitions/ErrorResponse"
                        }
                    },
                    "409": {
                        "description": "A record already exists for this time period",
                        "schema": {
                            "$ref": "#/definitions/ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/ErrorResponse"
                        }
                    }
                }
            }
        },
        "/daily-tracks/{id}": {
            "get": {
                "tags": ["DailyTrack"],
                "summary": "Get a daily track record by ID",
                "description": "Retrieves a single daily track record by its ID.",
                "operationId": "getDailyTrackById",
                "produces": ["application/json"],
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID of the daily track record to retrieve",
                        "required": true,
                        "type": "integer",
                        "format": "int64"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "schema": {
                            "$ref": "#/definitions/DailyTrack"
                        }
                    },
                    "404": {
                        "description": "Daily track record not found",
                        "schema": {
                            "$ref": "#/definitions/ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/ErrorResponse"
                        }
                    }
                }
            }
        }
    },
    "securityDefinitions": {
        "api_key": {
            "type": "apiKey",
            "name": "api_key",
            "in": "header"
        }
    },
    "definitions": {
        "Topic": {
            "type": "object",
            "required": ["id", "topic_name", "created_at", "updated_at"],
            "properties": {
                "id": {
                    "type": "integer",
                    "format": "int64",
                    "description": "Unique identifier for the topic"
                },
                "topic_name": {
                    "type": "string",
                    "description": "Name of the topic (e.g., 'playing', 'working')",
                    "example": "working"
                },
                "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Timestamp when the topic was created"
                },
                "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Timestamp when the topic was last updated"
                },
                "parent_topic_id": {
                    "type": "integer",
                    "format": "int64",
                    "description": "ID of the parent topic (null for root-level topics)"
                }
            }
        },
        "CreateTopicRequest": {
            "type": "object",
            "required": ["topic_name"],
            "properties": {
                "topic_name": {
                    "type": "string",
                    "description": "Name of the topic to create",
                    "example": "coding"
                },
                "parent_topic_id": {
                    "type": "integer",
                    "format": "int64",
                    "description": "Optional parent topic ID for hierarchical organization"
                }
            }
        },
        "DailyTrack": {
            "type": "object",
            "required": ["id", "start_time", "created_at", "updated_at", "topic_id"],
            "properties": {
                "id": {
                    "type": "integer",
                    "format": "int64",
                    "description": "Unique identifier for the daily track record"
                },
                "start_time": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Start time of the 30-minute period (must be at :00 or :30)"
                },
                "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Timestamp when the record was created"
                },
                "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Timestamp when the record was last updated"
                },
                "topic_id": {
                    "type": "integer",
                    "format": "int64",
                    "description": "ID of the associated topic"
                },
                "comment": {
                    "type": "string",
                    "description": "Optional notes or comments for this time period"
                }
            }
        },
        "CreateDailyTrackRequest": {
            "type": "object",
            "required": ["start_time", "topic_id"],
            "properties": {
                "start_time": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Start time of the 30-minute period (must be at :00 or :30)",
                    "example": "2026-01-03T10:00:00Z"
                },
                "topic_id": {
                    "type": "integer",
                    "format": "int64",
                    "description": "ID of the topic for this time period"
                },
                "comment": {
                    "type": "string",
                    "description": "Optional notes or comments",
                    "example": "Working on API design"
                }
            }
        },
        "ErrorResponse": {
            "type": "object",
            "required": ["error", "message"],
            "properties": {
                "error": {
                    "type": "string",
                    "description": "Error code",
                    "example": "VALIDATION_ERROR"
                },
                "message": {
                    "type": "string",
                    "description": "Human-readable error message",
                    "example": "start_time must be at :00 or :30 minutes"
                }
            }
        }
    }
}
